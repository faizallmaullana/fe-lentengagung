import{_ as K,q as S,r as f,p as b,s as V,c as n,a as t,d as i,b as P,m as I,g as C,t as l,n as F,F as h,y,A as E,S as d,x as L,o}from"./index-SbiDxUwW.js";const R={class:"h-[calc(100vh-4rem)] flex flex-col"},H={class:"flex items-center justify-between mb-4 px-1"},W={class:"flex items-center gap-4"},G={class:"text-xl font-bold text-gray-800 flex items-center gap-2"},O={key:0,class:"text-xs text-gray-500"},U={key:0,class:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-6 min-h-0"},q={class:"bg-white rounded-xl border border-gray-200 overflow-y-auto shadow-sm p-6 space-y-8 h-full custom-scrollbar"},z={key:0,class:"border-l-4 border-blue-500 bg-blue-50 p-4 rounded-r"},Z={class:"text-sm text-blue-700"},Y={key:1},J={class:"grid grid-cols-2 gap-y-4 gap-x-2 text-sm"},Q={class:"font-medium text-gray-900"},X={class:"font-medium text-gray-900"},ee={class:"font-medium text-gray-900"},te={class:"font-medium text-gray-900"},ae={class:"font-medium text-gray-900"},se={class:"font-medium text-gray-900"},re={class:"font-medium text-gray-900"},ne={class:"font-medium text-gray-900"},oe={class:"font-medium text-gray-900"},le={key:2},ie={class:"space-y-3"},ue={class:"flex justify-between font-bold text-gray-800"},de={class:"text-blue-600 bg-blue-50 px-2 rounded"},ce={class:"text-gray-500 mt-1"},me={class:"flex gap-2 mt-2"},pe={key:0,class:"text-xs text-green-600"},ge={key:1,class:"text-xs text-green-600"},xe={key:2,class:"text-xs text-red-600"},ve={key:3},ke={class:"space-y-3"},fe={class:"flex justify-between font-bold text-gray-800"},be={class:"text-purple-600 bg-purple-50 px-2 rounded"},he={class:"text-gray-500 mt-1"},ye={key:0,class:"text-xs text-green-600 mt-1"},we={key:4},_e={class:"space-y-2"},De={class:"font-medium"},Pe={key:0,class:"text-xs text-green-600"},Ne={key:1,class:"text-xs text-red-600"},je={class:"bg-gray-800 rounded-xl overflow-hidden flex flex-col shadow-lg h-full"},Ce={key:0,class:"bg-gray-900 p-2 flex justify-center gap-2 overflow-x-auto"},Fe=["onClick"],Le={class:"flex-1 bg-gray-700 flex items-center justify-center relative p-4 overflow-hidden"},Ae={key:0,class:"text-gray-400 text-center"},Be=["src"],Te={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-3 py-1 rounded-full text-xs backdrop-blur-sm"},$e={key:1,class:"flex-1 flex items-center justify-center"},Me={key:2,class:"flex-1 flex items-center justify-center"},Ke={class:"text-center text-red-600"},Se={class:"text-sm"},Ve={key:3,class:"mt-4 pt-4 border-t border-gray-200 flex justify-end gap-4 bg-gray-50 -mx-8 px-8 pb-4 sticky bottom-0"},Ie={key:4,class:"mt-4 pt-4 border-t border-gray-200 bg-gray-50 -mx-8 px-8 pb-4 sticky bottom-0"},Ee={class:"text-center text-gray-600"},Re={__name:"VerifikasiView",setup(He){const A=S(),g=I(),x=A.params.id,v=f(!0),p=f(null),k=f("ktp"),r=f(null),c=(s,e)=>e?`http://localhost:9090/api/upload/${s}/${e}`:null,m=b(()=>{if(!r.value)return[];const s=[],e=r.value.pewaris;return e?.ktpFileName&&s.push({key:"ktp_pewaris",label:"KTP Pewaris",url:c("ktp",e.ktpFileName),fileName:e.ktpFileName}),e?.aktaFileName&&s.push({key:"akta_kematian",label:"Akta Kematian",url:c("akta",e.aktaFileName),fileName:e.aktaFileName}),r.value.ahliWarisList?.forEach((a,u)=>{a.ktpFileName&&s.push({key:`ktp_ahli_${u}`,label:`KTP ${a.nama}`,url:c("ktp",a.ktpFileName),fileName:a.ktpFileName}),a.aktaFileName&&s.push({key:`akta_ahli_${u}`,label:`Akta ${a.nama}`,url:c("akta",a.aktaFileName),fileName:a.aktaFileName})}),r.value.saksiList?.forEach((a,u)=>{a.ktpFileName&&s.push({key:`ktp_saksi_${u}`,label:`KTP ${a.nama}`,url:c("ktp",a.ktpFileName),fileName:a.ktpFileName})}),r.value.dokumenPendukung?.forEach((a,u)=>{a.fileName&&s.push({key:`dokumen_${u}`,label:a.nama||`Dokumen ${u+1}`,url:c("documents",a.fileName),fileName:a.fileName})}),s}),w=b(()=>m.value.find(e=>e.key===k.value)?.url||null),N=async()=>{try{v.value=!0,p.value=null;const s=await E(`/form/${x}`);r.value=s,m.value.length>0&&(k.value=m.value[0].key)}catch(s){console.error("Error fetching form detail:",s),p.value=s.message||"Gagal memuat detail formulir"}finally{v.value=!1}},j=s=>s?new Date(s).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):"-",_=s=>({Pending:{text:"Menunggu Review",class:"bg-yellow-100 text-yellow-700",canAction:!0},Review:{text:"Dalam Review",class:"bg-blue-100 text-blue-700",canAction:!0},Disetujui:{text:"Disetujui",class:"bg-green-100 text-green-700",canAction:!1},Ditolak:{text:"Ditolak",class:"bg-red-100 text-red-700",canAction:!1},Approved:{text:"Disetujui",class:"bg-green-100 text-green-700",canAction:!1},Rejected:{text:"Ditolak",class:"bg-red-100 text-red-700",canAction:!1}})[s]||{text:s,class:"bg-gray-100 text-gray-700",canAction:!0},D=b(()=>r.value?r.value.status||"Review":null),B=b(()=>_(D.value).canAction);V(()=>{N()});const T=()=>{d.fire({title:"Setujui Permohonan?",text:"Status akan berubah menjadi 'Disetujui' dan notifikasi dikirim ke pemohon.",input:"textarea",inputLabel:"Alasan Persetujuan (Opsional)",inputPlaceholder:"Contoh: Dokumen lengkap dan valid, memenuhi persyaratan...",icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",confirmButtonText:"Ya, Setujui",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:async s=>{try{return await L(`/form/${x}/approve`,{reason:s||""})}catch(e){return d.showValidationMessage(`Error: ${e.message}`),!1}}}).then(s=>{s.isConfirmed&&d.fire({icon:"success",title:"Berhasil!",text:"Permohonan telah disetujui.",confirmButtonText:"Kembali ke Daftar"}).then(()=>{g.push("/admin/antrian")})})},$=()=>{d.fire({title:"Tolak Permohonan",text:"Silakan berikan alasan penolakan untuk pemohon.",input:"textarea",inputLabel:"Alasan Penolakan (Wajib)",inputPlaceholder:"Contoh: Scan KTP buram dan tidak terbaca, mohon upload ulang dengan kualitas yang lebih baik...",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Tolak Permohonan",cancelButtonText:"Batal",inputValidator:s=>{if(!s||s.trim().length<10)return"Alasan penolakan harus diisi minimal 10 karakter!"},showLoaderOnConfirm:!0,preConfirm:async s=>{try{return await L(`/form/${x}/reject`,{reason:s.trim()})}catch(e){return d.showValidationMessage(`Error: ${e.message}`),!1}}}).then(s=>{s.isConfirmed&&d.fire({icon:"success",title:"Permohonan Ditolak",text:"Alasan penolakan telah dikirim ke pemohon.",confirmButtonText:"Kembali ke Daftar"}).then(()=>{g.push("/admin/antrian")})})},M=()=>{let s;d.fire({title:"Membuat Draft Surat...",html:"Menyusun data ke dalam format resmi Kelurahan.",timer:2e3,timerProgressBar:!0,didOpen:()=>{d.showLoading()},willClose:()=>{clearInterval(s)}}).then(e=>{d.fire({icon:"success",title:"Draft Selesai!",text:"Draft PDF siap untuk dicetak atau ditandatangani.",confirmButtonText:"Lihat Preview PDF"})})};return(s,e)=>(o(),n("div",R,[t("div",H,[t("div",W,[t("button",{onClick:e[0]||(e[0]=a=>P(g).back()),class:"p-2 hover:bg-gray-100 rounded-full text-gray-500"},[...e[3]||(e[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})],-1)])]),t("div",null,[t("h1",G,[C(" Verifikasi: "+l(P(x))+" ",1),r.value?(o(),n("span",{key:0,class:F(["px-2 py-0.5 rounded text-xs border",_(D.value).class])},l(_(D.value).text),3)):i("",!0)]),r.value?(o(),n("p",O,"Form ID: "+l(r.value.id_form),1)):i("",!0)])]),t("div",{class:"flex gap-2"},[t("button",{onClick:M,class:"px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-lg hover:bg-blue-700 flex items-center gap-2 shadow-sm"},[...e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})],-1),C(" Generate Draft ",-1)])])])]),!v.value&&!p.value&&r.value?(o(),n("div",U,[t("div",q,[r.value&&r.value.alasan?(o(),n("div",z,[e[5]||(e[5]=t("h3",{class:"text-sm font-bold text-blue-800 mb-2"},"Keputusan Admin",-1)),t("p",Z,l(r.value.alasan),1)])):i("",!0),r.value.pewaris?(o(),n("div",Y,[e[15]||(e[15]=t("h3",{class:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b pb-2 mb-4"},"1. Data Pewaris",-1)),t("div",J,[e[6]||(e[6]=t("div",{class:"text-gray-500"},"NIK",-1)),t("div",Q,l(r.value.pewaris.nik||"-"),1),e[7]||(e[7]=t("div",{class:"text-gray-500"},"Nama Lengkap",-1)),t("div",X,l(r.value.pewaris.nama||"-"),1),e[8]||(e[8]=t("div",{class:"text-gray-500"},"Tanggal Lahir",-1)),t("div",ee,l(j(r.value.pewaris.tanggalLahir)),1),e[9]||(e[9]=t("div",{class:"text-gray-500"},"Tempat Lahir",-1)),t("div",te,l(r.value.pewaris.tempatLahir||"-"),1),e[10]||(e[10]=t("div",{class:"text-gray-500"},"Tanggal Meninggal",-1)),t("div",ae,l(j(r.value.pewaris.tanggalMeninggal)),1),e[11]||(e[11]=t("div",{class:"text-gray-500"},"Alamat",-1)),t("div",se,l(r.value.pewaris.alamat||"-"),1),e[12]||(e[12]=t("div",{class:"text-gray-500"},"Agama",-1)),t("div",re,l(r.value.pewaris.agama||"-"),1),e[13]||(e[13]=t("div",{class:"text-gray-500"},"Pekerjaan",-1)),t("div",ne,l(r.value.pewaris.pekerjaan||"-"),1),e[14]||(e[14]=t("div",{class:"text-gray-500"},"Status Perkawinan",-1)),t("div",oe,l(r.value.pewaris.statusPerkawinan||"-"),1)])])):i("",!0),r.value.ahliWarisList&&r.value.ahliWarisList.length>0?(o(),n("div",le,[e[16]||(e[16]=t("h3",{class:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b pb-2 mb-4"},"2. Data Ahli Waris",-1)),t("div",ie,[(o(!0),n(h,null,y(r.value.ahliWarisList,(a,u)=>(o(),n("div",{key:u,class:"p-3 bg-gray-50 rounded-lg border border-gray-100 text-sm"},[t("div",ue,[t("span",null,l(a.nama||"-"),1),t("span",de,l(a.hubungan||"-"),1)]),t("div",ce,"NIK: "+l(a.nik||"-"),1),t("div",me,[a.ktpFileName?(o(),n("div",pe," ✓ KTP tersedia ")):i("",!0),a.aktaFileName?(o(),n("div",ge," ✓ Dokumen akta tersedia ")):i("",!0),!a.ktpFileName&&!a.aktaFileName?(o(),n("div",xe," ✗ Belum ada dokumen ")):i("",!0)])]))),128))])])):i("",!0),r.value.saksiList&&r.value.saksiList.length>0?(o(),n("div",ve,[e[17]||(e[17]=t("h3",{class:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b pb-2 mb-4"},"3. Data Saksi",-1)),t("div",ke,[(o(!0),n(h,null,y(r.value.saksiList,(a,u)=>(o(),n("div",{key:u,class:"p-3 bg-gray-50 rounded-lg border border-gray-100 text-sm"},[t("div",fe,[t("span",null,l(a.nama||"-"),1),t("span",be,l(a.hubungan||"Saksi"),1)]),t("div",he,"NIK: "+l(a.nik||"-"),1),a.ktpFileName?(o(),n("div",ye," ✓ Dokumen KTP tersedia ")):i("",!0)]))),128))])])):i("",!0),r.value.dokumenPendukung&&r.value.dokumenPendukung.length>0?(o(),n("div",we,[e[18]||(e[18]=t("h3",{class:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b pb-2 mb-4"},"4. Dokumen Pendukung",-1)),t("div",_e,[(o(!0),n(h,null,y(r.value.dokumenPendukung,(a,u)=>(o(),n("div",{key:u,class:"flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-100 text-sm"},[t("span",De,l(a.nama||`Dokumen ${u+1}`),1),a.uploaded?(o(),n("span",Pe,"✓ Terupload")):(o(),n("span",Ne,"✗ Belum upload"))]))),128))])])):i("",!0)]),t("div",je,[m.value.length>0?(o(),n("div",Ce,[(o(!0),n(h,null,y(m.value,a=>(o(),n("button",{key:a.key,onClick:u=>k.value=a.key,class:F(["px-3 py-2 rounded text-xs font-semibold transition-colors whitespace-nowrap",k.value===a.key?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},l(a.label),11,Fe))),128))])):i("",!0),t("div",Le,[m.value.length===0?(o(),n("div",Ae,[...e[19]||(e[19]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-12 h-12 mx-auto mb-2 opacity-50"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m6.75 18.75h-8.25A2.25 2.25 0 016 19.5V4.5a2.25 2.25 0 012.25-2.25H9"})],-1),t("p",{class:"text-sm"},"Tidak ada dokumen tersedia",-1)])])):w.value?(o(),n("img",{key:1,src:w.value,alt:"Preview Dokumen",class:"max-h-full max-w-full object-contain shadow-2xl rounded",onError:e[1]||(e[1]=a=>a.target.style.display="none")},null,40,Be)):i("",!0),w.value?(o(),n("div",Te," Mode Pratinjau ")):i("",!0)])])])):v.value?(o(),n("div",$e,[...e[20]||(e[20]=[t("div",{class:"text-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t("p",{class:"mt-4 text-gray-500"},"Memuat detail formulir...")],-1)])])):p.value?(o(),n("div",Me,[t("div",Ke,[e[21]||(e[21]=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-12 h-12 mx-auto mb-2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})],-1)),e[22]||(e[22]=t("p",{class:"text-lg font-semibold"},"Error",-1)),t("p",Se,l(p.value),1),t("button",{onClick:N,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Coba Lagi ")])])):i("",!0),B.value?(o(),n("div",Ve,[t("button",{onClick:$,class:"px-6 py-2.5 border border-red-200 text-red-600 font-bold rounded-lg hover:bg-red-50 hover:border-red-300 transition-colors"}," Tolak Permohonan "),t("button",{onClick:T,class:"px-6 py-2.5 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 shadow-lg shadow-green-600/20 transition-colors"}," Setujui Permohonan ")])):r.value?(o(),n("div",Ie,[t("div",Ee,[e[23]||(e[23]=t("p",{class:"text-sm"},"Keputusan telah dibuat untuk formulir ini.",-1)),t("button",{onClick:e[2]||(e[2]=a=>P(g).push("/admin/antrian")),class:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm"}," Kembali ke Daftar ")])])):i("",!0)]))}},Ge=K(Re,[["__scopeId","data-v-e7d388d6"]]);export{Ge as default};
