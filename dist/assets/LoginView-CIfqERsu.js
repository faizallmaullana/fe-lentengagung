import{u as y,r as g,c as m,a as t,b as f,l as C,n,d as v,w as L,e as p,t as w,v as S,f as B,g as c,h as T,i as V,j as _,k as M,m as N,o as b,S as i}from"./index-SbiDxUwW.js";import{l as j}from"./login-bg-ByxHIqVW.js";const D={class:"bg-white w-full max-w-md rounded-xl shadow-2xl overflow-hidden border border-slate-100 relative z-10"},I={class:"p-6 text-center relative"},K=["src"],P={class:"flex border-b border-slate-100 bg-slate-50/50"},z={class:"p-8"},A={class:"block text-sm font-medium text-slate-700 mb-1"},$=["type","placeholder","disabled"],U=["disabled"],E=["disabled"],R={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},W={key:0,class:"mt-6 text-center text-sm text-slate-600"},O={__name:"LoginView",setup(q){const d=N(),x=y(),a=g("warga"),s=g(!1),r=g({identifier:"",password:""}),h=async()=>{s.value=!0;try{const o=await x.login(r.value.identifier,r.value.password,a.value);if(console.debug("[LOGIN] login result:",o),o.success){i.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:l=>{l.addEventListener("mouseenter",i.stopTimer),l.addEventListener("mouseleave",i.resumeTimer)}}).fire({icon:"success",title:`Selamat Datang, ${a.value==="warga"?"Warga":"Petugas"}!`}),console.warn(o);const u=o.data?.access_token;u&&(console.debug("[LoginView] saving authToken to localStorage"),localStorage.setItem("authToken",u)),a.value==="warga"?d.push("/dashboard/pengajuan"):d.push("/admin/antrian")}else console.warn("[LoginView] login failed:",o),i.fire({icon:"error",title:"Login Gagal",text:o.message||"Periksa kembali NIK dan Password Anda.",confirmButtonColor:"#d33",confirmButtonText:"Coba Lagi"})}catch{i.fire({icon:"error",title:"Kesalahan Sistem",text:"Terjadi gangguan koneksi. Silakan coba lagi nanti."})}finally{s.value=!1}},k=()=>{d.push("/")};return(o,e)=>{const u=_("RouterLink");return b(),m("div",{class:"min-h-screen flex items-center justify-center px-4 bg-cover bg-center relative",style:M({backgroundImage:`url(${f(j)})`})},[e[11]||(e[11]=t("div",{class:"absolute inset-0 bg-slate-900/50"},null,-1)),t("div",D,[t("div",I,[t("button",{onClick:k,class:"absolute left-6 top-6 text-slate-400 hover:text-slate-600 transition-colors",title:"Kembali ke Beranda"},[...e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})],-1)])]),t("img",{src:f(C),alt:"Logo",class:"h-12 w-auto mx-auto mb-3"},null,8,K),e[5]||(e[5]=t("h2",{class:"text-xl font-bold text-slate-800"},"Selamat Datang",-1)),e[6]||(e[6]=t("p",{class:"text-sm text-slate-500"},"Silakan masuk untuk melanjutkan",-1))]),t("div",P,[t("button",{class:n(["flex-1 py-3 text-sm font-medium transition-all border-b-2",a.value==="warga"?"text-green-700 border-green-600 bg-white shadow-sm":"text-slate-500 border-transparent hover:text-slate-700 hover:bg-slate-100"]),onClick:e[0]||(e[0]=l=>a.value="warga")}," Warga ",2),t("button",{class:n(["flex-1 py-3 text-sm font-medium transition-all border-b-2",a.value==="admin"?"text-blue-700 border-blue-600 bg-white shadow-sm":"text-slate-500 border-transparent hover:text-slate-700 hover:bg-slate-100"]),onClick:e[1]||(e[1]=l=>a.value="admin")}," Admin / Petugas ",2)]),t("div",z,[t("form",{onSubmit:L(h,["prevent"]),class:"space-y-5"},[t("div",null,[t("label",A,w(a.value==="warga"?"NIK (Nomor Induk Kependudukan)":"Username / NIP"),1),p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.identifier=l),type:a.value==="warga"?"number":"text",class:n(["w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:outline-none transition-all disabled:bg-slate-100",a.value==="warga"?"focus:ring-green-200 focus:border-green-500":"focus:ring-blue-200 focus:border-blue-500"]),placeholder:a.value==="warga"?"Contoh: 31740...":"Masukkan username petugas",required:"",disabled:s.value},null,10,$),[[S,r.value.identifier]])]),t("div",null,[e[7]||(e[7]=t("div",{class:"flex justify-between items-center mb-1"},[t("label",{class:"block text-sm font-medium text-slate-700"},"Kata Sandi"),t("a",{href:"#",class:"text-xs text-slate-400 hover:text-slate-600",tabindex:"-1"},"Lupa sandi?")],-1)),p(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>r.value.password=l),type:"password",class:n(["w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:outline-none transition-all disabled:bg-slate-100",a.value==="warga"?"focus:ring-green-200 focus:border-green-500":"focus:ring-blue-200 focus:border-blue-500"]),placeholder:"••••••••",required:"",disabled:s.value},null,10,U),[[B,r.value.password]])]),t("button",{type:"submit",disabled:s.value,class:n(["w-full py-2.5 px-4 text-white font-semibold rounded-lg shadow-md transition-all transform focus:ring-2 focus:ring-offset-1 cursor-pointer flex justify-center items-center gap-2",[a.value==="warga"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",s.value?"opacity-70 cursor-not-allowed hover:transform-none":"hover:-translate-y-0.5"]])},[s.value?(b(),m("svg",R,[...e[8]||(e[8]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):v("",!0),c(" "+w(s.value?"Memproses...":`Masuk sebagai ${a.value==="warga"?"Warga":"Admin"}`),1)],10,E)],32),a.value==="warga"?(b(),m("div",W,[e[10]||(e[10]=c(" Belum punya akun? ",-1)),T(u,{to:"/register",class:"text-green-600 font-semibold hover:underline"},{default:V(()=>[...e[9]||(e[9]=[c(" Daftar sekarang ",-1)])]),_:1})])):v("",!0)])])],4)}}};export{O as default};
