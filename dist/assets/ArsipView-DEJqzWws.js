import{r as h,p as f,s as B,c as r,a as e,t as n,e as y,B as V,F as k,y as b,f as S,d as U,g as _,A as T,S as d,o as a}from"./index-SbiDxUwW.js";const $={class:"space-y-6"},H={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},z={class:"text-sm text-gray-500"},E={key:0},F={key:1},N={class:"flex gap-3"},P=["disabled"],G=["value"],R={class:"relative"},Y={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},O={class:"w-full text-left text-sm text-gray-600"},I={class:"divide-y divide-gray-50"},K={key:0},Q={class:"px-6 py-4 font-mono text-blue-600 font-medium"},q={class:"px-6 py-4 font-bold text-gray-800"},J={class:"px-6 py-4"},W={class:"px-6 py-4"},X={class:"flex items-center gap-1 text-gray-500"},Z={class:"px-6 py-4 text-center"},ee={class:"px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700"},te={class:"px-6 py-4 text-right"},oe={class:"flex justify-end gap-2"},se=["onClick"],re=["onClick"],ae={key:0,class:"p-10 text-center text-gray-400"},ne={class:"flex flex-col items-center gap-3"},de={__name:"ArsipView",setup(le){const l=h(!0),m=h([]),i=h(""),u=h(""),C=async()=>{try{l.value=!0;const o=await T("/form/list");m.value=(o||[]).filter(t=>t.status==="Disetujui"||t.status==="Approved")}catch(o){console.error("Error fetching approved applications:",o),d.fire({icon:"error",title:"Error",text:"Gagal memuat data arsip dokumen"})}finally{l.value=!1}},A=o=>o?new Date(o).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",g=o=>o?new Date(o).getFullYear().toString():"",M=f(()=>{const o=m.value.map(t=>g(t.timestamp)).filter(t=>t);return[...new Set(o)].sort((t,s)=>s-t)}),v=f(()=>m.value.filter(o=>{const t=o.profile_name?.toLowerCase().includes(i.value.toLowerCase())||o.id?.toLowerCase().includes(i.value.toLowerCase())||o.user_email?.toLowerCase().includes(i.value.toLowerCase()),s=u.value?g(o.timestamp)===u.value:!0;return t&&s})),D=async o=>{try{d.fire({title:"Menyiapkan Dokumen PDF",html:`Mengunduh dokumen untuk ${o.profile_name}...`,allowOutsideClick:!1,didOpen:()=>d.showLoading()});const t="http://localhost:9090/api",s=localStorage.getItem("token"),p=`${t}/form/${o.id}/pdf`,w=await fetch(p,{method:"GET",headers:{Authorization:`Bearer ${s}`}});if(!w.ok)throw new Error("Gagal mengunduh PDF");const j=await w.blob(),x=window.URL.createObjectURL(j),c=document.createElement("a");c.href=x,c.download=`surat-pernyataan-${o.id}.pdf`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(x),d.fire({icon:"success",title:"Download Berhasil!",text:`Dokumen untuk ${o.profile_name} telah berhasil diunduh.`,confirmButtonColor:"#16a34a"})}catch(t){console.error("Error downloading PDF:",t),d.fire({icon:"error",title:"Download Gagal",text:"Terjadi kesalahan saat mengunduh dokumen. Silakan coba lagi.",confirmButtonText:"Tutup"})}},L=o=>{d.fire({title:"Mencetak...",text:`Menyiapkan antarmuka cetak untuk ${o.profile_name}`,icon:"info",timer:1e3,showConfirmButton:!1})};return B(()=>{C()}),(o,t)=>(a(),r("div",$,[e("div",H,[e("div",null,[t[2]||(t[2]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Arsip Digital",-1)),e("p",z,[l.value?(a(),r("span",E,"Memuat data...")):(a(),r("span",F,n(m.value.length)+" dokumen yang telah disetujui",1))])]),e("div",N,[y(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),class:"px-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white",disabled:l.value},[t[3]||(t[3]=e("option",{value:""},"Semua Tahun",-1)),(a(!0),r(k,null,b(M.value,s=>(a(),r("option",{key:s,value:s},n(s),9,G))),128))],8,P),[[V,u.value]]),e("div",R,[y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),type:"text",placeholder:"Cari Nama / No. Surat...",class:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 w-64 transition-all"},null,512),[[S,i.value]]),t[4]||(t[4]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-gray-400 absolute left-3 top-3"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1))])])]),e("div",Y,[e("table",O,[t[9]||(t[9]=e("thead",{class:"bg-gray-50 text-gray-500 font-semibold uppercase tracking-wider text-xs border-b border-gray-100"},[e("tr",null,[e("th",{class:"px-6 py-4"},"Kode Registrasi"),e("th",{class:"px-6 py-4"},"Nama Pemohon"),e("th",{class:"px-6 py-4"},"NIK"),e("th",{class:"px-6 py-4"},"Tanggal Disetujui"),e("th",{class:"px-6 py-4 text-center"},"Status"),e("th",{class:"px-6 py-4 text-right"},"Aksi")])],-1)),e("tbody",I,[l.value?(a(),r("tr",K,[...t[5]||(t[5]=[e("td",{colspan:"6",class:"px-6 py-8 text-center text-gray-500"},[e("div",{class:"flex justify-center items-center gap-2"},[e("svg",{class:"animate-spin h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),_(" Memuat arsip dokumen... ")])],-1)])])):(a(!0),r(k,{key:1},b(v.value,s=>(a(),r("tr",{key:s.id,class:"hover:bg-blue-50/30 transition-colors"},[e("td",Q,n(s.id||"-"),1),e("td",q,n(s.profile_name||s.user_email||"-"),1),e("td",J,n(s.profile_nik||"-"),1),e("td",W,[e("div",X,[t[6]||(t[6]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"})],-1)),_(" "+n(A(s.timestamp)),1)])]),e("td",Z,[e("span",ee,n(s.status==="Approved"?"Disetujui":s.status),1)]),e("td",te,[e("div",oe,[e("button",{onClick:p=>L(s),class:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded border border-transparent hover:border-gray-200 transition-all",title:"Cetak Salinan"},[...t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0110.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0l.229 2.523a1.125 1.125 0 01-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 00-1.913-.247M6.34 18H5.25A2.25 2.25 0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 001.913-.247m10.5 0a48.536 48.536 0 00-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"})],-1)])],8,se),e("button",{onClick:p=>D(s),class:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded border border-blue-100 transition-all",title:"Unduh PDF"},[...t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})],-1)])],8,re)])])]))),128))])]),!l.value&&v.value.length===0?(a(),r("div",ae,[e("div",ne,[t[10]||(t[10]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-12 h-12 opacity-50"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})],-1)),e("p",null,n(i.value||u.value?"Tidak ada dokumen yang cocok dengan filter.":"Belum ada dokumen yang disetujui."),1)])])):U("",!0)])]))}};export{de as default};
